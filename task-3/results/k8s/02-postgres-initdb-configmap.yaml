apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-initdb
  namespace: analytics
data:
  01_init.sql: |
    CREATE TABLE IF NOT EXISTS shipments (
      shipment_id   BIGSERIAL PRIMARY KEY,
      client_id     BIGINT NOT NULL,
      status        TEXT NOT NULL,
      created_at    TIMESTAMP NOT NULL DEFAULT NOW()
    );

    INSERT INTO shipments (client_id, status, created_at) VALUES
      (101, 'CREATED',  NOW() - INTERVAL '1 day'),
      (102, 'IN_TRANSIT', NOW() - INTERVAL '12 hours'),
      (103, 'DELIVERED',  NOW() - INTERVAL '2 hours')
    ON CONFLICT DO NOTHING;
